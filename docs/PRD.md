# AI TikTok 产品视频生成系统

## Product Requirements Document (PRD)

**Version:** 1.0
**Date:** 2026-02-20
**Author:** Mantou AI Studio
**Status:** Draft

---

## 1. 概述

### 1.1 产品简介

一套自动化 AI 视频生成系统，帮助跨境电商卖家快速将产品图片转化为 TikTok 营销短视频。用户只需上传产品照片，系统自动完成扩图、卖点提取、脚本生成、视频制作全流程。

### 1.2 目标用户

- 跨境电商卖家（TikTok Shop）
- 电商代运营公司
- 短视频内容制作团队

### 1.3 核心价值

| 痛点 | 解决方案 |
|------|----------|
| 手动流程繁琐，单个视频耗时 2-3 小时 | 自动化流水线，10 分钟出片 |
| 需要多个工具切换（ChatGPT、Wink、Sora...） | 一站式平台，上传即出片 |
| 卖点提炼靠经验，质量不稳定 | AI + 竞品数据，标准化输出 |
| 无法批量生产 | 支持批量上传，队列处理 |

---

## 2. 系统架构

### 2.1 技术栈

| 层级 | 技术选型 | 说明 |
|------|----------|------|
| 前端 | Next.js 14 + Tailwind | 简洁管理界面 |
| 后端 | Python FastAPI | API 服务 |
| 工作流 | n8n (self-hosted) | 流程编排 |
| 数据库 | PostgreSQL | 任务/用户数据 |
| 存储 | 阿里云 OSS | 图片/视频存储 |
| 队列 | Redis + Celery | 异步任务处理 |

### 2.2 核心流程

```
┌─────────────────────────────────────────────────────────────────┐
│                        用户上传产品图片                           │
│                      (3-9张，支持批量/Excel)                      │
└─────────────────────────────────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────┐
│  STEP 1: AI 图片处理                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │ ChatGPT     │ -> │ 高清修复     │ -> │ 九宫格合成   │         │
│  │ DALL·E 扩图 │    │ (Real-ESRGAN)│    │ (可选)      │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
└─────────────────────────────────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────┐
│  STEP 2: 卖点收集与分析                                          │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │ 用户输入     │ +  │ FastMoss    │ +  │ ChatGPT    │         │
│  │ 产品资料     │    │ 竞品数据     │    │ 智能补充    │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
└─────────────────────────────────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────┐
│  STEP 3: 视频提示词生成                                          │
│  ┌─────────────────────────────────────────────────────┐       │
│  │ 脚本结构: 痛点开头(3s) + 卖点展示 + 引导下单          │       │
│  │ 输出: 视频内容提示词 + 产品外形提示词                  │       │
│  └─────────────────────────────────────────────────────┘       │
└─────────────────────────────────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────┐
│  STEP 4: AI 视频生成                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │ Sora        │ OR │ Creatok     │ OR │ Seedance    │         │
│  │ (主选)      │    │ (备选)      │    │ (国内备选)   │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
│  生成 3 个版本用于 A/B 测试                                       │
└─────────────────────────────────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────┐
│  STEP 5: 输出                                                    │
│  - 9:16 竖屏视频 (15s / 30s)                                     │
│  - 下载 / 在线预览                                                │
│  - 历史记录管理                                                   │
└─────────────────────────────────────────────────────────────────┘
```

---

## 3. 功能清单

### 3.1 P0 - MVP 核心功能（必须）

| 模块 | 功能 | 描述 |
|------|------|------|
| 用户系统 | 简单登录 | 3个固定账号，用户名密码登录 |
| 图片上传 | 单品上传 | 上传 3-9 张产品图 |
| 图片上传 | 批量上传 | 多产品同时上传 |
| 图片上传 | Excel 导入 | 批量导入产品信息 |
| AI 扩图 | ChatGPT 扩图 | 调用 DALL·E API 扩展图片 |
| AI 扩图 | 高清修复 | Real-ESRGAN 超分辨率 |
| 卖点分析 | 手动输入 | 用户填写产品卖点/痛点 |
| 卖点分析 | AI 补充 | ChatGPT 智能补充卖点 |
| 提示词 | 自动生成 | 根据卖点生成视频脚本提示词 |
| 提示词 | 产品锁定 | 生成产品外形描述提示词 |
| 视频生成 | Sora 生成 | 调用 Sora API 生成视频 |
| 视频生成 | Creatok 生成 | 备选视频生成服务 |
| 视频生成 | 多版本 | 每产品生成 3 个版本 |
| 输出 | 视频下载 | 下载生成的视频文件 |
| 输出 | 历史记录 | 查看历史生成记录 |

### 3.2 P1 - 增强功能（二期）

| 模块 | 功能 | 描述 |
|------|------|------|
| 竞品分析 | FastMoss 对接 | 自动抓取竞品数据 |
| 竞品分析 | 达人视频分析 | 输入 TikTok 链接，提取卖点 |
| 后期处理 | AI 配音 | 自动生成语音旁白 |
| 后期处理 | 自动字幕 | 语音转字幕 |
| 后期处理 | 背景音乐 | 音乐库 + 自动匹配 |
| 品牌 | Logo 水印 | 添加品牌标识 |
| 品牌 | 片头片尾 | 统一模板 |

### 3.3 P2 - SaaS 功能（三期）

| 模块 | 功能 | 描述 |
|------|------|------|
| 用户系统 | 注册登录 | 完整用户体系 |
| 用户系统 | 多租户 | 不同客户数据隔离 |
| 计费 | 按量计费 | 按视频生成数量收费 |
| 计费 | 套餐订阅 | 月度/年度套餐 |

---

## 4. 页面设计

### 4.1 页面列表

| 页面 | 路由 | 功能 |
|------|------|------|
| 登录页 | /login | 账号密码登录 |
| 仪表盘 | /dashboard | 任务概览、快捷入口 |
| 新建任务 | /tasks/new | 上传图片、填写信息 |
| 任务列表 | /tasks | 查看所有任务状态 |
| 任务详情 | /tasks/:id | 查看单个任务进度、下载视频 |
| 批量导入 | /import | Excel 批量导入 |

### 4.2 新建任务流程

```
Step 1: 上传图片
┌────────────────────────────────────┐
│  拖拽或点击上传产品图片             │
│  ┌─────┐ ┌─────┐ ┌─────┐          │
│  │ 📷 │ │ 📷 │ │ + │          │
│  └─────┘ └─────┘ └─────┘          │
│  已上传 2/9 张                      │
└────────────────────────────────────┘
                 │
                 ▼
Step 2: 填写产品信息
┌────────────────────────────────────┐
│  产品名称: [                    ]   │
│  产品卖点: [                    ]   │
│  目标痛点: [                    ]   │
│  使用场景: [                    ]   │
│  [AI 智能补充卖点]                  │
└────────────────────────────────────┘
                 │
                 ▼
Step 3: 生成设置
┌────────────────────────────────────┐
│  视频时长: ○ 15秒  ● 30秒          │
│  生成版本: ○ 1个  ● 3个  ○ 5个     │
│  视频服务: ● Sora  ○ Creatok       │
│                                    │
│  [ 开始生成 ]                       │
└────────────────────────────────────┘
```

---

## 5. API 设计

### 5.1 核心 API

| 方法 | 路径 | 功能 |
|------|------|------|
| POST | /api/auth/login | 用户登录 |
| POST | /api/tasks | 创建任务 |
| GET | /api/tasks | 获取任务列表 |
| GET | /api/tasks/:id | 获取任务详情 |
| POST | /api/tasks/:id/generate | 开始生成视频 |
| GET | /api/tasks/:id/videos | 获取生成的视频 |
| POST | /api/upload/images | 上传图片 |
| POST | /api/import/excel | Excel 批量导入 |
| POST | /api/ai/expand-image | AI 扩图 |
| POST | /api/ai/enhance-selling-points | AI 补充卖点 |
| POST | /api/ai/generate-prompt | 生成视频提示词 |

### 5.2 任务状态流转

```
pending → processing → generating → completed
                ↓           ↓
              failed      failed
```

---

## 6. 外部服务集成

### 6.1 AI 服务

| 服务 | 用途 | API | 预估成本 |
|------|------|-----|----------|
| OpenAI GPT-4 | 卖点分析、提示词生成 | api.openai.com | $0.03/次 |
| OpenAI DALL·E 3 | 图片扩展 | api.openai.com | $0.04/张 |
| Replicate Real-ESRGAN | 高清修复 | replicate.com | $0.002/张 |
| Sora | 视频生成 | sora.chatgpt.com | $0.20/视频 |
| Creatok | 视频生成(备选) | api.creatok.ai | 待确认 |
| Seedance | 视频生成(国内备选) | 字节 API | 待确认 |

### 6.2 基础设施

| 服务 | 用途 | 预估成本 |
|------|------|----------|
| 阿里云 ECS | 应用服务器 | ¥500/月 |
| 阿里云 OSS | 文件存储 | ¥50/月 |
| 阿里云 RDS PostgreSQL | 数据库 | ¥200/月 |
| Redis | 任务队列 | ¥100/月 |

### 6.3 网络代理

由于 ChatGPT/Sora 需要境外网络，服务端需配置代理：
- 方案: Cloudflare Workers 中转 或 境外服务器部署

---

## 7. 数据模型

### 7.1 用户表 (users)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | uuid | 主键 |
| username | varchar(50) | 用户名 |
| password_hash | varchar(255) | 密码哈希 |
| created_at | timestamp | 创建时间 |

### 7.2 任务表 (tasks)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | uuid | 主键 |
| user_id | uuid | 用户 ID |
| product_name | varchar(200) | 产品名称 |
| selling_points | text | 卖点 |
| pain_points | text | 痛点 |
| status | enum | pending/processing/generating/completed/failed |
| video_duration | int | 视频时长(秒) |
| version_count | int | 生成版本数 |
| video_service | varchar(20) | sora/creatok/seedance |
| created_at | timestamp | 创建时间 |
| completed_at | timestamp | 完成时间 |

### 7.3 图片表 (images)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | uuid | 主键 |
| task_id | uuid | 任务 ID |
| original_url | varchar(500) | 原图 URL |
| expanded_url | varchar(500) | 扩图后 URL |
| enhanced_url | varchar(500) | 高清后 URL |
| type | enum | original/expanded/enhanced |

### 7.4 视频表 (videos)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | uuid | 主键 |
| task_id | uuid | 任务 ID |
| version | int | 版本号 (1/2/3) |
| url | varchar(500) | 视频 URL |
| prompt | text | 使用的提示词 |
| duration | int | 时长(秒) |
| status | enum | pending/generating/completed/failed |

---

## 8. n8n 工作流设计

### 8.1 主工作流

```
Webhook (接收任务)
    │
    ├─► [图片处理流程]
    │       ├─► HTTP: DALL·E 扩图
    │       └─► HTTP: Real-ESRGAN 高清
    │
    ├─► [卖点分析流程]
    │       └─► HTTP: GPT-4 补充卖点
    │
    ├─► [提示词生成]
    │       ├─► HTTP: GPT-4 视频脚本
    │       └─► HTTP: GPT-4 产品描述
    │
    └─► [视频生成] (循环3次)
            ├─► HTTP: Sora API
            └─► Webhook: 回调更新状态
```

### 8.2 工作流文件

将在 `n8n-workflows/` 目录下创建：
- `main-workflow.json` - 主流程
- `image-processing.json` - 图片处理子流程
- `video-generation.json` - 视频生成子流程

---

## 9. 项目排期

### MVP 开发计划（2-3周）

| 阶段 | 任务 | 预估 |
|------|------|------|
| Week 1 | 项目初始化、数据库设计、用户系统 | 2天 |
| Week 1 | 图片上传模块、OSS 对接 | 1天 |
| Week 1 | AI 扩图、高清修复集成 | 2天 |
| Week 2 | 卖点分析、提示词生成 | 2天 |
| Week 2 | 视频生成集成 (Sora/Creatok) | 2天 |
| Week 2 | 任务队列、状态管理 | 1天 |
| Week 3 | 前端界面开发 | 3天 |
| Week 3 | 测试、部署、交付 | 2天 |

---

## 10. 风险与应对

| 风险 | 概率 | 影响 | 应对措施 |
|------|------|------|----------|
| Sora API 不稳定/受限 | 高 | 高 | 准备 Creatok/Seedance 备选 |
| ChatGPT 境外网络问题 | 中 | 高 | Cloudflare Workers 中转 |
| 视频生成成本超预算 | 中 | 中 | 限制每日生成数量 |
| 去水印效果不理想 | 高 | 低 | 优先使用无水印服务 |

---

## 11. 附录

### 11.1 参考资料

- 原始流程文档: `/Users/mantou/Downloads/AI流程.docx`
- Sora: https://sora.chatgpt.com/
- Creatok: https://www.creatok.ai/
- 去水印工具: https://ezremove.ai/sora-watermark-remover/

### 11.2 术语表

| 术语 | 说明 |
|------|------|
| 扩图 | 使用 AI 扩展图片边缘，生成更大画幅 |
| 九宫格 | 将多张产品图拼接成 3x3 布局的合成图 |
| 提示词 | 输入给 AI 视频生成模型的文字描述 |
| A/B 测试 | 同一产品生成多个版本，测试哪个效果更好 |

---

## Changelog

| 版本 | 日期 | 变更 |
|------|------|------|
| 1.0 | 2026-02-20 | 初版 PRD |
